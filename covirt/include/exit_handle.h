//define exit_code to find handler
//see volume 2 appendix c
//Damn, I don't trust myself for this long table. Check it again tonight.
#define VMEXIT_CR0_READ			    0x0
#define VMEXIT_CR1_READ			    0x1
#define VMEXIT_CR2_READ			    0x2
#define VMEXIT_CR3_READ			    0x3
#define VMEXIT_CR4_READ			    0x4
#define VMEXIT_CR5_READ			    0x5
#define VMEXIT_CR6_READ			    0x6
#define VMEXIT_CR7_READ			    0x7
#define VMEXIT_CR8_READ			    0x8
#define VMEXIT_CR9_READ			    0x9
#define VMEXIT_CR10_READ		    0xA
#define VMEXIT_CR11_READ		    0xB
#define VMEXIT_CR12_READ		    0xC
#define VMEXIT_CR13_READ		    0xD
#define VMEXIT_CR14_READ		    0xE
#define VMEXIT_CR15_READ		    0xF
#define VMEXIT_CR0_WRITE		    0x10
#define VMEXIT_CR1_WRITE		    0x11
#define VMEXIT_CR2_WRITE		    0x12
#define VMEXIT_CR3_WRITE		    0x13
#define VMEXIT_CR4_WRITE		    0x14
#define VMEXIT_CR5_WRITE		    0x15
#define VMEXIT_CR6_WRITE		    0x16
#define VMEXIT_CR7_WRITE		    0x17
#define VMEXIT_CR8_WRITE		    0x18
#define VMEXIT_CR9_WRITE		    0x19
#define VMEXIT_CR10_WRITE		    0x1A
#define VMEXIT_CR11_WRITE		    0x1B
#define VMEXIT_CR12_WRITE		    0x1C
#define VMEXIT_CR13_WRITE		    0x1D
#define VMEXIT_CR14_WRITE		    0x1E
#define VMEXIT_CR15_WRITE		    0x1F
#define VMEXIT_DR0_READ			    0x20
#define VMEXIT_DR1_READ			    0x21
#define VMEXIT_DR2_READ			    0x22
#define VMEXIT_DR3_READ			    0x23
#define VMEXIT_DR4_READ			    0x24
#define VMEXIT_DR5_READ			    0x25
#define VMEXIT_DR6_READ			    0x26
#define VMEXIT_DR7_READ			    0x27
#define VMEXIT_DR8_READ			    0x28
#define VMEXIT_DR9_READ			    0x29
#define VMEXIT_DR10_READ		    0x2A
#define VMEXIT_DR11_READ		    0x2B
#define VMEXIT_DR12_READ		    0x2C
#define VMEXIT_DR13_READ		    0x2D
#define VMEXIT_DR14_READ		    0x2E
#define VMEXIT_DR15_READ		    0x2F
#define VMEXIT_DR0_WRITE		    0x30
#define VMEXIT_DR1_WRITE		    0x31
#define VMEXIT_DR2_WRITE		    0x32
#define VMEXIT_DR3_WRITE		    0x33
#define VMEXIT_DR4_WRITE		    0x34
#define VMEXIT_DR5_WRITE		    0x35
#define VMEXIT_DR6_WRITE		    0x36
#define VMEXIT_DR7_WRITE		    0x37
#define VMEXIT_DR8_WRITE		    0x38
#define VMEXIT_DR9_WRITE		    0x39
#define VMEXIT_DR10_WRITE		    0x3A
#define VMEXIT_DR11_WRITE		    0x3B
#define VMEXIT_DR12_WRITE		    0x3C
#define VMEXIT_DR13_WRITE		    0x3D
#define VMEXIT_DR14_WRITE		    0x3E
#define VMEXIT_DR15_WRITE		    0x3F
#define VMEXIT_EXCP0			    0x40
#define VMEXIT_EXCP1			    0x41
#define VMEXIT_EXCP2				0x42
#define VMEXIT_EXCP3				0x43
#define VMEXIT_EXCP4				0x44
#define VMEXIT_EXCP5				0x45
#define VMEXIT_EXCP6				0x46
#define VMEXIT_EXCP7				0x47
#define VMEXIT_EXCP8				0x48
#define VMEXIT_EXCP9				0x49
#define VMEXIT_EXCP10				0x4A
#define VMEXIT_EXCP11				0x4B
#define VMEXIT_EXCP12				0x4C
#define VMEXIT_EXCP13				0x4D
#define VMEXIT_EXCP14				0x4E
#define VMEXIT_EXCP15				0x4F
#define VMEXIT_EXCP16				0x50
#define VMEXIT_EXCP17				0x51
#define VMEXIT_EXCP18				0x52
#define VMEXIT_EXCP19				0x53
#define VMEXIT_EXCP20				0x54
#define VMEXIT_EXCP21				0x55
#define VMEXIT_EXCP22				0x56
#define VMEXIT_EXCP23				0x57
#define VMEXIT_EXCP24				0x58
#define VMEXIT_EXCP25				0x59
#define VMEXIT_EXCP26				0x5A
#define VMEXIT_EXCP27				0x5B
#define VMEXIT_EXCP28				0x5C
#define VMEXIT_EXCP29				0x5D
#define VMEXIT_EXCP30				0x5E
#define VMEXIT_EXCP31				0x5F
#define VMEXIT_INTR					0x60
#define VMEXIT_NMI					0x61
#define VMEXIT_SMI					0x62
#define VMEXIT_INIT					0x63
#define VMEXIT_VINTR				0x64
#define VMEXIT_CR0_SEL_WRITE		0x65
#define VMEXIT_IDTR_READ			0x66
#define VMEXIT_GDTR_READ			0x67
#define VMEXIT_LDTR_READ			0x68
#define VMEXIT_TR_READ				0x69
#define VMEXIT_IDTR_WRITE			0x6A
#define VMEXIT_GDTR_WRITE			0x6B
#define VMEXIT_LDTR_WRITE			0x6C
#define VMEXIT_TR_WRITE				0x6D
#define VMEXIT_RDTSC				0x6E
#define VMEXIT_RDPMC				0x6F
#define VMEXIT_PUSHF				0x70
#define VMEXIT_POPF					0x71
#define VMEXIT_CPUID				0x72
#define VMEXIT_RSM					0x73
#define VMEXIT_IRET					0x74
#define VMEXIT_SWINT				0x75
#define VMEXIT_INVD					0x76
#define VMEXIT_PAUSE				0x77
#define VMEXIT_HLT					0x78
#define VMEXIT_INVLPG				0x79
#define VMEXIT_INVLPGA				0x7A
#define VMEXIT_IOIO					0x7B
#define VMEXIT_MSR					0x7C
#define VMEXIT_TASK_SWITCH			0x7D
#define VMEXIT_FERR_FREEZE			0x7E
#define VMEXIT_SHUTDOWN				0x7F
#define VMEXIT_VMRUN				0x80
#define VMEXIT_VMMCALL				0x81
#define VMEXIT_VMLOAD				0x82
#define VMEXIT_VMSAVE				0x83
#define VMEXIT_STGI					0x84
#define VMEXIT_CLGI					0x85
#define VMEXIT_SKINIT				0x86
#define VMEXIT_RDTSCP				0x87
#define VMEXIT_ICEBP				0x88
#define VMEXIT_WBINVD				0x89
#define VMEXIT_MONITOR				0x8A
#define VMEXIT_MWAIT				0x8B
#define VMEXIT_MWAIT_CONDITIONAL	0x8C
#define VMEXIT_RDPRU	            0x8E    //don't know why E is in front of D in the manual
#define VMEXIT_XSETBV	            0x8D
#define VMEXIT_EFER_WRITE_TRAP	    0x8F
#define VMEXIT_CR0_WRITE_TRAP	    0x90
#define VMEXIT_CR1_WRITE_TRAP	    0x91
#define VMEXIT_CR2_WRITE_TRAP	    0x92
#define VMEXIT_CR3_WRITE_TRAP	    0x93
#define VMEXIT_CR4_WRITE_TRAP	    0x94
#define VMEXIT_CR5_WRITE_TRAP	    0x95
#define VMEXIT_CR6_WRITE_TRAP	    0x96
#define VMEXIT_CR7_WRITE_TRAP	    0x97
#define VMEXIT_CR8_WRITE_TRAP	    0x98
#define VMEXIT_CR9_WRITE_TRAP	    0x99
#define VMEXIT_CR10_WRITE_TRAP	    0x9A
#define VMEXIT_CR11_WRITE_TRAP	    0x9B
#define VMEXIT_CR12_WRITE_TRAP	    0x9C
#define VMEXIT_CR13_WRITE_TRAP	    0x9D
#define VMEXIT_CR14_WRITE_TRAP	    0x9E
#define VMEXIT_CR15_WRITE_TRAP	    0x9F
#define VMEXIT_INVLPGB              0xA0
#define VMEXIT_INVLPGB_ILLEGAL      0xA1
#define VMEXIT_INVPCID              0xA2
#define VMEXIT_MCOMMIT              0xA3
#define VMEXIT_TLBSYNC              0xA4
#define VMEXIT_NPF					0x400
#define AVIC_INCOMPLETE_IPI         0x401
#define AVIC_NOACCEL                0x402
#define VMEXIT_VMGEXIT              0x403
#define VMEXIT_INVALID				-1
#define VMEXIT_BUSY				    -2


void handle_vmexit(void);

void handle_phys_int(void);

void handle_ioio(void);

void handle_cpuid(void);